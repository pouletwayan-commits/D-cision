<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Décision — MVP v2</title></head>
<body>
  <h1>Décision — MVP v2</h1>
  <p><button id="btnTest">Tester connexion OpenAI</button> <span id="testResult"></span></p>
  <input type="file" id="audio" accept="audio/*">
  <button id="btnAnalyze">Analyser</button>
  <pre id="output"></pre>
<script>
document.getElementById('btnTest').onclick = async () => {
  const r = await fetch('/api/test-openai');
  const j = await r.json().catch(()=>({}));
  document.getElementById('testResult').textContent = JSON.stringify(j);
};
document.getElementById('btnAnalyze').onclick = async () => {
  const file = document.getElementById('audio').files[0];
  if (!file) return alert('Choisissez un fichier audio');
  const form = new FormData();
  form.append('audio', file);
  const res = await fetch('/api/process', { method: 'POST', body: form });
  const text = await res.text();
  try{ document.getElementById('output').textContent = JSON.stringify(JSON.parse(text), null, 2); }
  catch{ document.getElementById('output').textContent = text; }
};
</script>
</body></html>
